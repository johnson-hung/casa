<!--  This file is app/views/announcements/index.html.erb -->
<p>
  <%= flash[:alert] if flash[:alert] %>
  <%= link_to 'Home', root_path %>
</p>


<% if current_user %>

<p align="right">
<%= current_user.email %>
<%= link_to "Log out", logout_path, method: "post", :class => 'btn btn-primary pull-right' %>
</p>
  
<% else %>

<p align="right">
  <%= link_to 'Login', login_path, :class => 'btn btn-primary pull-right ' %>
  <%= link_to 'Signup', signup_url, :class => 'btn btn-primary pull-right' %>
</p>


<% end %>




<h2>Announcement</h2>

<%= form_tag announcements_path, :method => :get, :id => 'ratings_form' do %>
  <%= hidden_field_tag "title_sort", true if @title_header %>
  <%= hidden_field_tag ":release_date_sort", true if @date_header %>
<% end %>

<table class="table table-striped col-md-12" style="width: 100%; table-layout: fixed;" id="announcements">
  <tbody>
    <% @announcements.each do |announcement| %>
      <tr>
        <td class="text-nowrap" style="width: 70%;">
          <div class="font-weight-bold">
            <p>
              <%= link_to "#{announcement.title}", announcement_path(announcement) %>
            </p>
          </div>
          <p class="text-truncate">
            <%= announcement.description %>
          </p>
        </td>
        <td class="text-nowrap" style="width: 20%;">
          <div class="font-weight-bold">
            <p>Posted on:</p>
          </div>
          <div>
            <%= announcement.release_date %>
          </div>
        </td>
        
        <td class="text-nowrap" style="width: 10%;">
          <% if current_user %>
          <div class="text-center">
            <%= link_to 'Edit', edit_announcement_path(announcement), :class => 'btn btn-primary' %>
          </div>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<!-- TBD (should check if user is organizer) -->
<% if current_user %>
<div class="col-md-12 text-center">
  <%= link_to 'Add Announcement', new_announcement_path, :class => 'btn btn-primary' %>
</div>
<% end %>

<% if current_user %>
<h2>Can see this if logged in</h2>
  <%= text_field :announcement, :title, :class => 'form-control' %>
<% end %>